<% gender = character.get('gender'); %>
<% name = (gender == 'x' || !gender) ? 'name' : 'name_' + gender; %>
<% skills = character.get_skill_items(); %>

<section class="span6 print-box">
    <h1><%= character.get('name') %></h1>

    <h3 data-for="profession"><%= character.get('profession').get(name) || character.get('profession').get("name")
        %></h3>
    <label class="subline" for="profession">Profession</label>

    <h3 data-for="culture"><%= character.get('culture').get(name) || character.get('culture').get("name") %></h3>
    <label class="subline" for="culture">Kultur</label>

    <h3 data-for="race"><%= character.get('race').get(name) || character.get('race').get("name") %></h3>
    <label class="subline" for="race">Rasse</label>
</section>

<section class="span6 print-box">
    <div id="logo">
        <img src="/images/dsa5.png"/>

        <h2 class="subcaption">Heldendokument</h2>
    </div>

    <label for="character.profile.hair">Haarfarbe</label>
    <span data-for="character.profile.hair"><%= character.get('profile')['hair'] %></span>

    <label for="character.profile.eye">Augenfarbe</label>
    <span data-for="character.profile.eye"><%= character.get('profile')['eye'] %></span>

    <label for="character.profile.height">Größe</label>
    <span data-for="character.profile.height"><%= character.get('profile')['height'] %></span>

    <label for="character.profile.weight">Gewicht</label>
    <span data-for="character.profile.weight"><%= character.get('profile')['weight'] %></span>

    <label for="character.lifegrade">Erfahrungsgrad</label>
    <span data-for="character.lifegrade"><%= character.get('lifegrade').get(name) || character.get('lifegrade').get("name") %></span>

    <label for="character.social">Sozialstatus</label>
    <span data-for="character.social"><%= character.get('social') %></span>
</section>

<section class="span6 print-box">
    <h2>Eigenschaften</h2>

    <% _.each(character.get('attributes'), function (value, key) { %>
    <% if (key in character.defaults.attributes) { %>
    <b><%= key %></b>
    <label class="subdesc" for="attributes"><%= __(key) %></label>
    <span data-for="attributes.<%= key %>"><%= value %></span>
    <span data-for="attributes.<%= key %>_max"><%= 18 + (character.get('attributes')[key + "_max"] || 0) %></span>
    <br/>
    <% } %>
    <% }); %>

    <div class="spacer">&nbsp;</div>

    <h2>Abgeleitete Werte</h2>

    <table>
        <thead>
        <tr>
            <th width="25%">&nbsp;</th>
            <th width="17%">Grundwert</th>
            <th width="17%">Bonus</th>
            <th width="17%">Gekauft</th>
            <th width="24%">Aktuell</th>
        </tr>
        </thead>
        <tbody>
        <% _.each(['GS', 'MR', 'INI', 'LE', 'AE', 'KE', 'EDG'], function (key) { %>
        <tr data-key="<%= key %>" data-value="<%= character.get('attributes')[key] %>">
            <td>
                <b><%= key %></b>
                <label class="subdesc"><%= __(key) %></label>
            </td>
            <td data-for="attributes.<%= key %>.base">
                <%= (character.get('race').get('attributes')[key] || 0) %>
            </td>
            <td data-for="attributes.<%= key %>.bonus">
                <%= (character.get('attributes')[key] || 0) - (character.get('race').get('attributes')[key] || 0) -
                (character.attributes['attributes'][key] || 0) %>
            </td>
            <td data-for="attributes.<%= key %>">
                <%= character.attributes['attributes'][key] || 0 %>
            </td>
            <td data-for="attributes.<%= key %>.current">
                <%= character.get('attributes')[key] %>
            </td>
        </tr>
        <% }); %>
        </tbody>
    </table>
</section>

<section class="span6 print-box">
    <h2>Vorteile & Nachteile</h2>

    <% var i = 17; %>
    <% _.each(skills, function (skill) { %>
    <% if (skill.item && skill.item.isVantage()) { %>
    <h3 data-for="skills.<%= skill.key %>">
        <%= skill.item.toString(skill.value) %>
    </h3>
    <% i--; %>
    <% } %>
    <% }); %>
    <% while (i-- > 0) { %>
    <h3 data-for="skills">
        &nbsp;
    </h3>
    <% } %>
</section>

<div class="pagebreak">
    <hr/>
</div>

<% function printSkillBox(skills, key) { %>
<h2><%= key %></h2>

<table>
    <thead>
    <tr>
        <th width="40%">Name</th>
        <th width="18%">Probe</th>
        <th width="6%">BE</th>
        <th width="6%">SF</th>
        <th width="12%">FW</th>
        <th width="18%">&nbsp;</th>
    </tr>
    </thead>
    <tbody>
    <% _.each(skills, function (skill) { %>
    <% if (skill.item && skill.groups.indexOf(key) >= 0) { %>
    <tr>
        <td data-for="skills.<%= skill.key %>.name"><%= skill.key %></td>
        <td class="center" data-for="skills.<%= skill.key %>.dices"><%= skill.item.get('dices').join("/") %></td>
        <td class="center" data-for="skills.<%= skill.key %>.BE"><%= skill.item.get('BE') && "j" || "n" %></td>
        <td class="center" data-for="skills.<%= skill.key %>.SF"><%= skill.item.get('SF') %></td>
        <td class="center" data-for="skills.<%= skill.key %>.value"><%= skill.value %></td>
        <td data-for="skills.<%= skill.key %>.comment">&nbsp;</td>
    </tr>
    <% } %>
    <% }); %>
    <tr>
        <td data-for="skills.name">&nbsp;</td>
        <td data-for="skills.dices">&nbsp;</td>
        <td data-for="skills.BE">&nbsp;</td>
        <td data-for="skills.SF">&nbsp;</td>
        <td data-for="skills.value">&nbsp;</td>
        <td data-for="skills.comment">&nbsp;</td>
    </tr>
    </tbody>
</table>
<% } %>


<section class="span6 print-box">
    <% printSkillBox(skills, __('Körpertalente')) %>
    <% printSkillBox(skills, __('Gesellschaftstalente')) %>
    <% printSkillBox(skills, __('Naturtalente')) %>
    <% printSkillBox(skills, __('Gaben')) %>
</section>

<section class="span6 print-box">
    <div id="logo">
        <img src="/images/dsa5.png"/>

        <h2 class="subcaption">Talentdokument</h2>
    </div>

    <table>
        <thead>
        <tr>
            <% _.each(character.get('attributes'), function (value, key) { %>
            <% if (key in character.defaults.attributes) { %>
            <th width="12.5%"><%= key %></th>
            <% } %>
            <% }); %>
        </tr>
        </thead>
        <tbody>
        <tr>
            <% _.each(character.get('attributes'), function (value, key) { %>
            <% if (key in character.defaults.attributes) { %>
            <td data-for="attributes.<%= key %>"><%= value %></td>
            <% } %>
            <% }); %>
        </tr>
        </tbody>
    </table>

    <% printSkillBox(skills, __('Wissenstalente')) %>
    <% printSkillBox(skills, __('Handwerkstalente')) %>

</section>





